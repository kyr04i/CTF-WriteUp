import json
from pwn import *
data = {
    "hash": 90332780745442119779253857231558597566447620910226630319466684469499960556217,
    "ctxt": 73051477874175319898927301574056890898704116542880899811855416465272643682482346872783064596681132500093342543927350264317816705056726017562052386926181322166187767850184465510257796954957460330077783876352326207867696650111732540101368587373210436484887313543491225210356125240581684161338044619494047854900183079330422962318329546393970108675111208668731515310810119669669785116258853775579596914067264319604960692189737974799003960161097925809658756864172165995060221657693350799455527766362031052645281448993284426009064500366073322116732260765304288850209892843144957962916560778212599399552579286945076904181402045509524352633967429874194201741806721664196445347759142097532829953125517498551062761903031892701576548444435244611198108640987159546381903097946809287365052398012455687453466700260273341554786191027926777189035233725939692111334381040651927022112173802116643713729121047574308803077213575536485741502404927006914803136414467058642884171002528878169339845622793977402503234182588769709154961649934730828326538949645182926356414533497836632833727562183129066423778578583057064315858610392480954433559213008717680626378247498277787414520519791236257431556708009843017374097633810653489799748754465484619328171001827,
    "n": 12382690007872699569559851255749820705952531180883042515378211591935412568568451403921039901725589626295241935858486541491598015040501739357487561483554722425337845668049093791935331775036123970172411943074252981081477698074732964343999776121594925414192610353924799565195903832723318698139379810195815784333254851253277613023666497803636189573179425333792358078017514088818442942427471555006155691577836475567115627124701787064379237400205896230069631546843578716597432859352734515116816241873541076114350524811099104267144459529542519817220778584255019896362646045520462050536788862731464209286412465665804683965629
}
n = data["n"]
ctxt = data["ctxt"]

HOST = os.environ.get('HOST', 'localhost')
PORT = 31337

io = remote(HOST, int(PORT))

s1 = b"ls"
s2 = b"./submitter"
m1 = int.from_bytes(s1, 'big')
m2 = int.from_bytes(s2, 'big')

m3 = (m2 * pow(m1, -1, n)) % n

new_ctxt = pow(ctxt, m3, n**2)

pload = json.dumps({"hash": int(hashlib.sha256(s2).hexdigest(), 16), "ctxt": new_ctxt, "n": n})

io.sendlineafter("> ", "4 " + pload)
flag = io.recvline_contains(b'LiveCTF{').decode().strip()
log.info('Flag: %s', flag)
